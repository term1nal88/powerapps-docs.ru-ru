---
title: Преобразование форм InfoPath в приложения PowerApps | Документы Майкрософт
description: Начните преобразование форм InfoPath в PowerApps, воспользовавшись подробными сведениями о распространенных сценариях InfoPath и создании аналогичных элементов в PowerApps.
author: richardriley99
ms.service: powerapps
ms.topic: article
ms.component: canvas
ms.date: 04/05/2018
ms.author: rriley
ms.openlocfilehash: 10fe4e9052b9c029046c515c229e95075988597a
ms.sourcegitcommit: 7354a0c61578fcc0b9965bf557b9d7c553c73e96
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/05/2018
ms.locfileid: "34803519"
---
# <a name="transform-your-infopath-forms-to-powerapps"></a>Преобразуйте формы InfoPath в приложения PowerApps

Вы конструируете отличные формы в InfoPath и хотите узнать, как перенести их на более надежную платформу?

## <a name="key-advantages-of-powerapps-over-infopath"></a>Основные преимущества PowerApps по сравнению с InfoPath

Как и большинство опытных пользователей InfoPath, вы используете свои уникальные навыки для создания отличных форм. Хотя вас устраивает качество этих форм, тем не менее вам известно, что у них есть свои ограничения: &quot;классическое&quot; оформление, далеко не идеальная работа на мобильных устройствах, неуверенность в их будущей устойчивости и постоянные проблемы, когда речь заходит о подключении к другим службам без написания кода.

Команде разработчиков PowerApps было известно об этих и многих других проблемах. Они приложили все усилия, чтобы создать для вас более удобную среду работы в PowerApps. Их цель — дать вам возможность создавать приложения, используя ваши навыки в сфере бизнеса и технологий. С помощью PowerApps вы сможете быстро построить и развернуть эффективные бизнес-решения без написания кода.

**За PowerApps будущее**  
PowerApps — это платформа "программное обеспечение как услуга" (SaaS), позволяющая вам быстро создавать эффективные приложения, которые можно развертывать на веб-сайтах, в SharePoint, Dynamics 365, Teams, Power BI или на мобильных устройствах без дополнительных усилий. Поскольку они просты в развертывании (для установки вы передаете пользователю URL-адрес опубликованного приложения), их также легко обновлять.

**Публикация приложений**  
Вы когда-нибудь пробовали создать приложение, а затем опубликовать его в магазине Google или Apple App Store? Это сложно. Дополнительная сложность возникает, если вы хотите развернуть второе приложение или обновить существующее, — вашим пользователям потребуется выполнить гораздо больше действий. Но не в PowerApps. Пользователи устанавливают приложение Microsoft PowerApps из магазина приложений, а затем входят в систему с именем пользователя и паролем учетной записи Майкрософт и сразу же получают доступ ко всем приложениям, которые вы для них предоставили. В дальнейшем при обновлении этих приложений или публикации новых приложений для этих пользователей они будут отображаться на их устройствах. Мобильные приложения без необходимости управления устройствами — это большое преимущество для вас и вашего бизнеса.

**Кстати, о мобильных устройствах**  
Благодаря PowerApps вы можете использовать возможности мобильных устройств пользователей. У вас есть доступ к ускорению, камере, компасу, сведениям о подключении и сигналам о расположении — все это прямо из приложения. Это дает вам целый ряд преимуществ для создания эффективных приложений. И, конечно, функциональные возможности сенсорного ввода предоставляются в PowerApps автоматически без необходимости написания дополнительного кода.

**Готовые к работе**  
В InfoPath вы, как правило, работали с данными из одного источника. Однако если вам требовалось внести изменения где-то еще (например, в списке SharePoint в другом семействе сайтов) или подключиться к внешним службам, все значительно усложнялось, и такие понятия, как код программной части, сильно затрудняли вам жизнь. Но не с PowerApps. Эта платформа позволяет вам работать с несколькими источниками данных и подключениями к службам в одном приложении. Сейчас существует [более 150 соединителей](https://docs.microsoft.com/powerapps/connections-list#all-connectors), поддерживающих сочетание локальных и облачных данных, Microsoft Office 365 и таких служб Azure, как Flow и Dynamics 365, а также несколько сторонних служб, включая такие популярные целевые платформы, как Dropbox, Google, Salesforce и Slack. Теперь вы можете создавать решения для масштабирования приложений в любых средах, а не только там, где хранятся исходные данные.

## <a name="powerapps-and-sharepoint-even-better-together"></a>PowerApps и SharePoint: вместе еще эффективнее

PowerApps — это мощный инструмент для улучшения взаимодействия с SharePoint двумя способами: вы можете настроить формы для списка SharePoint или создать автономное приложение для работы с данными SharePoint.

**Настройка формы SharePoint** — хороший вариант, если пользователи будут использовать список для повседневной работы, а вам требуется настроить способы добавления, просмотра и редактирования элементов в списке SharePoint. Когда вы нажмете кнопку **Настройка форм**, будет создано &quot;приложение форм&quot; с одним экраном, которое будет изменять режим (создание, редактирование, просмотр) в зависимости от контекста. Такие приложения управляются SharePoint; их разрешения аналогичны разрешениям списка для просмотра и редактирования.

**Создание приложения холста PowerApps из SharePoint** позволяет запустить приложение автономно на мобильном устройстве. Кроме того, его можно встроить в страницу SharePoint. При нажатии этой кнопки создается приложение из трех экранов (представление списка, форма создания или изменения, форма представления).  Модель управления доступом и разрешениями для этих приложений не привязана к SharePoint, а управляется из PowerApps.

Теперь, когда вы поняли разницу между двумя вариантами, следующий раздел дает вам представление об использовании каждого варианта.

## <a name="sharepoint-forms"></a>Формы SharePoint

Команды разработчиков PowerApps и SharePoint совместно разработали новую модель настройки использования с SharePoint.  Большинству разработчиков InfoPath приходилось обеспечивать взаимодействие InfoPath и SharePoint. Сама по себе SharePoint — отличная платформа, однако формы по умолчанию не представляют из себя ничего особенного и не поддерживают настройки или бизнес-логику без InfoPath. Теперь это в прошлом.

Благодаря PowerApps вы можете настраивать формы списков как внутренние функции. И при этом в вашем распоряжении — все возможности PowerApps. На снимке экрана ниже вы видите пример формы PowerApps со встроенным отчетом Power BI.  Все решение было создано менее чем за 15 минут.

![Интеграция с SharePoint](./media/transform-infopath/sharepoint-integration.png)

Еще одна важная возможность PowerApps — возможность простого подключения к другому семейству сайтов SharePoint или другой среде из одной формы. Например, вы хотите сделать одну форму, в которой можно выводить и обновлять данные из SharePoint Online и локальной среды SharePoint одновременно? Это несложно. Установите [локальный шлюз данных](https://docs.microsoft.com/powerapps/gateway-management) и через несколько минут вы получите рабочее подключение между PowerApps, Power BI, Microsoft Flow, Azure Logic Apps и локальными данными. Изменение правила брандмауэра не требуется. Еще один уровень функциональных возможностей открывается при подключении приложения к Microsoft Flow.

## <a name="a-standalone-sharepoint-app"></a>Автономное приложение SharePoint

Если вместо простого интерфейса обновления формы со списком вы хотите построить полнофункциональное автономное приложение, основанное на данных SharePoint, используйте этот метод. Это также лучший способ знакомства с технологией: вы можете начать изучать возможности холста PowerApps и создания будущих приложений на основе любого из нескольких источников данных.

Для начала перейдите к списку SharePoint, с которым требуется настроить взаимодействие, а затем:

1. нажмите кнопку PowerApps в строке меню;
2. выберите "Создать приложение";
3. укажите имя;
4. нажмите кнопку "Создать".

PowerApps создаст приложение по умолчанию, которое затем можно настроить.

Начните с простого приложения. Для первого приложения используйте простой настраиваемый список из нескольких полей разных типов. Таким образом, вы сможете создать прочный фундамент без лишних проблем и усилий. Не беспокойтесь; совсем скоро вы станете профессионалом и будете готовы к созданию сложных приложений.  Если вам нужна помощь при создании такого первого приложения, ознакомьтесь с этой [документацией](https://docs.microsoft.com/powerapps/generate-app-from-sharepoint-list-interface) или этим [видеороликом](https://youtu.be/BnYe_7fpZRM) сообщества. В приведенных ниже примерах показываются типичные задачи InfoPath и способы их решения в PowerApps. Все они основаны на простом приложении-списке SharePoint.

# <a name="how-do-you-do-that-with-powerapps"></a>Как это сделать с помощью PowerApps

После того как вы ознакомились с основными понятиями, можно двигаться дальше. На базе созданного вами первого приложения сведения в следующем разделе помогут применить некоторые основные понятия InfoPath в PowerApps.

**Скрыть, показать или заблокировать поле на основе значения**  
Одна из надежных основ успешной формы — наличие эффективной бизнес-логики и умение эту логику применять. Один из способов — изменять состояние поля на основе значения или действия. В PowerApps вы можете выбрать элемент управления и задать для него режим отображения (DisplayMode) "Просмотр" или "Изменение", чтобы указать, разрешено ли пользователю изменять поле. Второй способ — использование формулы If, реализующей алгоритм условий. Сначала выберите метку, которую требуется изменить, и щелкните значок замка, чтобы разблокировать карточку. Это позволит вам изменить значение.

![Скрыть, показать, заблокировать карточку данных](./media/transform-infopath/hide-show-lock.png)

Теперь перейдите в нижнюю правую часть карточки и измените значение свойства DefaultMode.

![Выражения инструкции If Else](./media/transform-infopath/if-else-statement.png)

В этом примере используется инструкция If. If(ThisItem.Color = &quot;Blue&quot;, DisplayMode.View, DisplayMode.Edit) В этой инструкции говорится, что если поле Color текущего элемента имеет значение Blue, то поле animal доступно только для чтения; в противном случае поле можно редактировать.

Если вы вообще не хотите отображать карточку, аналогичную функцию можно вставить в поле Visible (Видимое) сразу над DisplayMode.

Кроме того, вы, например, можете скрыть кнопку утверждения, чтобы она отображалась только при совпадении адреса электронной почты пользователя с адресом электронной почты утверждающего. Подсказка: User().Email служит для получения доступа к адресу электронной почты текущего пользователя. Таким образом, можно задать для кнопки Visible (Видимое) значение If(YourDataCard.Text = User().Email, true, false), где YourDataCard — это карточка, где хранится адрес электронной почты утверждающего.

**Условное форматирование**  
Аналогичным образом (как и для скрытия поля выше) можно предоставлять визуальную обратную связь для пользователей. Возможно, вам требуется выделить текст красным цветом, если введенное значение выходит за пределы допустимого диапазона, или изменить текст и цвет кнопки "Отправить", чтобы удалить кнопку после отправки файла. Эти действия выполняются с помощью функций, таких как If, в полях свойств, таких как Color или Visible.

Например, можно использовать функцию If вместе с функцией [IsMatch](https://docs.microsoft.com/powerapps/functions/function-ismatch), чтобы менять цвет текста в поле электронной почты на красный, если пользователь указал в поле ввода адрес электронной почты в неправильном формате. Это можно сделать, задав значение поля Color равным TextInput1 в If(IsMatch(TextInput1.Text, Email), Black, Red), где TextInput1 — это поле, в котором пользователь вводит адрес электронной почты. IsMatch поддерживает множество предварительно определенных шаблонов, таких как адрес электронной почты, а также позволяет создавать свои собственные. Дополнительные сведения об условном форматировании см. в этом [видеоролике сообщества](https://powerusers.microsoft.com/t5/Video-Webinar-Gallery/PowerApps-Conditional-Formatting-and-Popups/m-p/84962).

**Реализация безопасности на основе ролей**  
Первая функция, которую мы рассмотрим, — [DataSourceInfo](https://docs.microsoft.com/powerapps/functions/function-datasourceinfo). То, какие сведения вы получаете из источника данных, зависит от источника данных, но, как правило, DataSourceInfo(YourDataSource, DataSourceInfo.EditPermission) можно использовать для проверки наличия у пользователя разрешений на изменение данных. Замените YourDataSource именем своего источника данных. Таким образом, форма или кнопка будет отображаться, только если пользователь имеет доступ для редактирования. Полный список сведений, которые можно запрашивать в функции, см. в документации по DataSourceInfo.

Если вместо этого вы хотите использовать группы Active Directory для управления доступом к кнопкам или формам в приложении, вам потребуются более глубокие знания. Для этого можно воспользоваться преимуществами PowerApps и создать собственный соединитель с помощью API Microsoft Graph. И хотя это может показаться сложной задачей, существуют пошаговые [руководства](https://powerapps.microsoft.com/blog/implementing-role-based-permission/), которые вам помогут.

**Отправка сообщения электронной почты из приложения**  
Существует множество способов отправки сообщения электронной почты из PowerApps. Проще всего использовать соединитель Outlook в Office 365. С помощью этого соединителя вы можете отправлять сообщения из приложения от своего имени. Кроме того, можно получать сообщения электронной почты и другие задачи, которые взаимодействуют с почтовым ящиком. Подробные сведения об отправке сообщений см. в [документации](https://docs.microsoft.com/powerapps/connections/connection-office365-outlook) или этом [видеоролике](https://powerusers.microsoft.com/t5/Video-Webinar-Gallery/Send-an-email-from-PowerApps/m-p/74349) сообщества.

Если вам требуется отправить более сложное сообщение электронной почты, например путем создания цепочки утверждения рабочего процесса утверждения SharePoint, попробуйте создать поток Microsoft Flow и подключить к нему приложение. При подключении приложения к Microsoft Flow вы открываете широчайшие возможности подсистемы рабочих процессов, которая, как и PowerApps, очень эффективно подключается к внешним данным и службам. Дополнительные сведения о подключении PowerApps и Microsoft Flow см. в этой [документации](https://docs.microsoft.com/powerapps/using-logic-flows).

Если вам по-прежнему не удалось найти оптимальный вариант работы с электронной почтой, вы также можете использовать соединители PowerApps для таких почтовых систем, как Benchmark Email, Gmail, MailChimp, Outlook.com, SendGrid или SMTP. Это очередное преимущество подключений PowerApps.

**Рабочие процессы**  
Трудно говорить о бизнес-приложениях и бизнес-логике без подсистемы рабочих процессов. Хорошие новости — разработчики PowerApps не стали изобретать велосипед и создавать очередную подсистему рабочих процессов. Вместо этого они предоставили надежный соединитель со службой Microsoft Flow. Теперь вы можете автоматизировать процессы и задачи для более чем [200 различных служб](https://flow.microsoft.com/connectors/) благодаря простой в использовании подсистеме рабочих процессов. Дополнительные сведения о подключении PowerApps и Microsoft Flow см. в этой [документации](https://docs.microsoft.com/powerapps/using-logic-flows).

**Переменные в PowerApps**  
При построении решения логично предположить, что в нем потребуется использовать переменные. Хотя в PowerApps предлагается три типа переменных, вы наверняка предпочтете не использовать их без необходимости. Предположим, что вместо того, чтобы получать данные, сохранять их в переменной, а затем ссылаться на эту переменную, вы можете сослаться на данные напрямую. Лучше всего это получается у Excel. В Excel поле "Итог" не является переменной, — это сумма значений других полей. Таким образом, если вы хотите использовать это значение в другом месте на листе, вы указываете поле, в котором вычисляется итог. В этой [документации](https://docs.microsoft.com/powerapps/working-with-variables) приводится отличное объяснение всех этих возможностей. Не стоит ограничиваться одним вариантом.

Если вам все-таки необходимо использовать переменные (есть много таких ситуаций), вы, тем не менее, можете использовать разные способы. Помните, что в PowerApps вам необязательно определять переменные. Чтобы создать переменную, просто используйте одну из функций для указания имени и хранимого значения. Вы можете просматривать созданные переменные, щелкнув в строке меню "Показать" и выбрав "Переменные". Переменные хранятся в памяти, и их значения утрачиваются при закрытии приложения. Существуют три типа переменных.

- Глобальные переменные — первое, что приходит в голову. Вы можете использовать функцию [Set](https://docs.microsoft.com/powerapps/functions/function-set), чтобы указать значение для переменной, которое затем будет доступно в приложении. Пример использования функции — Set(YourVariable, YourValue). Затем вы можете ссылаться в приложении на переменную YourVariable по имени.
- Переменные контекста — это переменные, доступные только на экране, в котором они определены. При выходе из экрана они будут сброшены. Эти переменные часто используются для хранения данных, переданных из предыдущего экрана, или, например, для отслеживания того, отправлена ли форма. Самое распространенное применение [UpdatedContext](https://docs.microsoft.com/powerapps/functions/function-updatecontext) — UpdateContext( { Submitted: "true" } ). В этом случае для переменной Submitted задается значение true. Вы можете сделать так, чтобы эта часть кнопки "Отправить" на странице отслеживала отправку данных и преобразовывала все поля в поля только для чтения. Примечание. Коллекции ":" используются для хранения таблиц данных, которые можно обновлять по отдельности. Начальные сведения есть в описании функции [Collect](https://docs.microsoft.com/powerapps/functions/function-clear-collect-clearcollect). В качестве примера использования можно привести создание корзины для покупок, в которую отправляются различные элементы SharePoint, помечаемые пользователем. Эта концепция в действии показана в этом [видеоролике](https://powerusers.microsoft.com/t5/Video-Webinar-Gallery/Learn-about-PowerApps-Collections/m-p/89180) сообщества.

**Каскадные раскрывающиеся меню**  
Каскадные раскрывающиеся меню очень удобны. Они позволяют фильтровать варианты в одном раскрывающемся списке на основе значения, выбранного в предыдущем раскрывающемся списке. В PowerApps их часто создают при использовании двух источников данных в приложении. Первый источник данных — это данные, с которыми вы работаете или которые изменяете, а второй источник данных используется для хранения значения для создания необходимого каскадного эффекта. Ниже приведен пример второго источника данных с вариантами выбора.

![Каскадные раскрывающиеся меню](./media/transform-infopath/cascading-dropdowns.png)

Теперь мы создадим первый раскрывающийся список и для свойства Items будем использовать формулу Distinct(Impacts, Title), чтобы выводить в раскрывающемся списке только пункты Cost, Program Impact и Schedule. Затем мы добавим второй раскрывающийся список и присвоим свойству Items значение Filter(Impacts,ddSelectType.Selected.Value in SCategory), где ddSelectType — это имя первого раскрывающегося списка. Вот так и получаются каскадные раскрывающиеся меню. Дополнительные сведения см. в этой публикации команды разработчиков PowerApps [SharePoint: Cascading Dropdowns in 4 Easy Steps!](https://powerusers.microsoft.com/t5/PowerApps-Community-Blog/SharePoint-Cascading-Dropdowns-in-4-Easy-Steps/ba-p/16248) или этом [видеоролике сообщества](https://powerusers.microsoft.com/t5/Video-Webinar-Gallery/PowerApps-Cascading-Dropdown/m-p/92813). И не беспокойтесь, это можно сделать так же просто без SharePoint.

**Не создавайте одно суперприложение**  
В PowerApps одно приложение можно вызывать из другого, поэтому вместо огромной формы InfoPath, которая не разваливается только чудом, можно создать группу приложений, вызывающих друг друга, и даже передавать между ними данные. Это значительно упрощает разработку.

## <a name="next-steps"></a>Дальнейшие действия

Используя полученные знания, теперь вы можете попробовать свои силы в PowerApps и, никуда не торопясь, создать собственное приложение. По мере того как вы будете набираться опыта, вам пригодятся следующие полезные ресурсы. Обратите внимание на ссылку на сайт сообщества PowerApps. Чем раньше вы станете участником сообщества, тем быстрее сможете развить свои навыки: вместе всегда проще, чем в одиночку.

[**Справочник по формулам**](https://docs.microsoft.com/en-us/powerapps/formula-reference) — даже если вы просто будете просматривать стандартные формулы, вам в голову может прийти отличная идея.

[**Сообщество PowerApps**](https://powerusers.microsoft.com/t5/PowerApps-Community/ct-p/PowerApps1) — здесь вы можете получить примеры кода и ответы на свои вопросы и, общаясь с другими разработчиками, помогать расти сообществу PowerApps.