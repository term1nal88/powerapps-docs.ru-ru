---
title: Создание связи между списками SharePoint с помощью поля подстановки | Документация Майкрософт
description: Сведения о создании связи между списками SharePoint с помощью поля подстановки.
services: powerapps
documentationcenter: na
author: skjerland
manager: anneta
editor: ''
tags: ''
ms.service: powerapps
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 01/20/2017
ms.author: sharik
ms.openlocfilehash: a1966016b07a79a23880511a5cc0d6da8643adbc
ms.sourcegitcommit: 59785e9e82da8f5bd459dcb5da3d5c18064b0899
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2018
---
# <a name="how-to-link-sharepoint-lists-using-lookup-fields"></a>Как связать списки SharePoint с помощью полей подстановки
В этом руководстве показано, как связать два списка SharePoint с помощью полей подстановки.

## <a name="overview"></a>Обзор
SharePoint предоставляет два типа полей подстановки:

* **Подстановка**. Создает связь с другим списком. Например, список *Заказы* может содержать поле подстановки со ссылками на клиентов в списке *Клиенты*.
* **Выбор**. Если щелкнуть это поле, откроется меню выбора элементов.

В рамках этого руководства вы создадите приложение с этими типами полей подстановки.

### <a name="what-do-you-use-lookup-fields-for"></a>Предназначение полей подстановки
Каждая организация хранит большое количество сложных данных. Данные в списке SharePoint часто связаны с данными в другом списке. Поля подстановки позволяют связывать эти бизнес-данные.

Например, у вас может быть список **Заказы** с полем подстановки, связывающим этот список со списком **Клиенты**, что позволяет просмотреть, какой клиент разместил заказ. Поле подстановки в списке **Заказы** позволяет также получать данные из списка **Клиенты**. Кроме того, поле подстановки позволяет создать связь между списком **Заказы** и **Товар**, благодаря чему вы можете просмотреть необходимые сведения о заказанном товаре, например изображение товара, характеристики, сведения о производителе и т. д.

### <a name="what-are-choice-fields-used-for"></a>Предназначение поля выбора
Поле **выбора** используется для очень кратких списков, но в этом случае вы не создаете отдельный список, а просто включаете значения списка в небольшое меню, которое отображается при выборе этого **поля**. В конечном итоге вам нужно выбрать одно из значений.

Например, это может быть код состояния клиента, параметры доступности товара, коды стран. По сути, любой относительно короткий постоянный список. Можно реализовать эти данные в виде отдельных списков, а затем создать связь между ними с помощью **поля подстановки**, но обычно быстрее и проще реализовать их в качестве полей **выбора**.

## <a name="create-the-lists-in-sharepoint"></a>Создание списков в SharePoint
В этом разделе вы создадите связь между двумя настраиваемыми списками SharePoint: **Ресурсы** и **Мастерская**. Список **Ресурсы** используется, чтобы отслеживать оборудование команды. Так как время от времени оборудование выходит из строя, мы используем список **Мастерская**, чтобы отслеживать местные мастерские, где его можно починить.

### <a name="the-lookup-fields-used-in-this-example"></a>В этом примере использовались поля подстановки
В списке **Мастерская** содержится поле *Адрес электронной почты*, используемое для определения мастерской. Этот список определяется первым, поэтому каждая строка в списке **Ресурсы** указывает на что-либо.

Список **Ресурсы** содержит два поля подстановки:

* поле *Мастерская* типа **Подстановка**, указывающее на записи в списке **Мастерская** на основе адресов электронной почты,
* и поле *Тип ресурсов* типа **Выбор**, содержащее список возможных типов оборудования.

В зависимости от информации, которую необходимо отслеживать, вы можете определить дополнительные поля.

### <a name="define-the-repairshop-list-and-add-data"></a>Определение списка "Мастерская" и добавление данных
Это действие выполняется вначале. Поэтому когда вы добавляете данные в список **Ресурсы**, записи списка **Мастерская** можно выбрать в поле подстановки *Ресурсы.Мастерская*.

1. На сайте SharePoint создайте список **Мастерская**.

    ![](./media/sharepoint-lookup-fields/new-list.png)

2. Добавьте поле *Адрес электронной почты* типа **Однострочный текст**.

    ![](./media/sharepoint-lookup-fields/add-email-field.png)

3. При необходимости добавьте другие поля.

4. Щелкните **+ Создать**, чтобы добавить образцы данных в этот список (по крайней мере 3 строки с разными значениями *Адрес электронной почты*). Если нужно починить ресурс, вы можете выбрать одно их этих значений.

    ![](./media/sharepoint-lookup-fields/add-repair-shops.png)

### <a name="define-the-assets-list"></a>Определение списка "Ресурсы"
1. На сайте SharePoint создайте список **Ресурсы**.

2. Щелкните знак "плюс" и выберите **Дополнительно**.

    ![](./media/sharepoint-lookup-fields/choose-more-type.png)

3. Добавьте поле *Тип ресурса* типа **Выбор** и в текстовом поле **Введите варианты выбора (каждый в отдельной строке)** введите значения, которые будут отображаться в меню выбора. Нажмите кнопку **ОК**.

    ![](./media/sharepoint-lookup-fields/define-choice-column.png)

4. Теперь добавим еще одно поле. Так же как и на шаге 2, щелкните знак "плюс" и выберите **Дополнительно**.

5. Добавьте поле *Мастерская* типа **Подстановка**, в текстовом поле **Get information from** (Получение сведений из) выберите **Мастерская**, а затем в текстовом поле **In this column** (В этом столбце) выберите *Адрес электронной почты*. Нажмите кнопку **ОК**.

    ![](./media/sharepoint-lookup-fields/setup-lookup-column.png)

6. При необходимости добавьте дополнительные поля.

## <a name="create-an-app-from-the-assets-list"></a>Создание приложения из списка "Ресурсы"
Это приложение позволяет добавлять данные в список **Ресурсы**.

1. Откройте PowerApps Studio. Если вы еще не работали с PowerApps, [зарегистрируйтесь бесплатно](https://powerapps.microsoft.com), используя адрес электронной почты организации, а затем выполните указания, чтобы скачать PowerApps Studio из Магазина Windows.

2. В меню **Файл** (с левой стороны) щелкните **Создать**, а затем выберите **SharePoint**.

    ![](./media/sharepoint-lookup-fields/create-app.png)

1. В списке **Последние сайты** выберите сайт SharePoint или введите URL-адрес сайта непосредственно в текстовом поле. Нажмите кнопку **Перейти**.

    ![](./media/sharepoint-lookup-fields/choose-sharepoint-site.png)

1. На сайте SharePoint выберите главный список (в этом примере **Ресурсы**). В правом нижнем углу нажмите кнопку **Подключиться**.

    ![](./media/sharepoint-lookup-fields/choose-main-list.png)


## <a name="add-data-to-the-assets-list"></a>Добавление данных в список "Ресурсы"
Теперь вы можете запустить приложение и посмотреть, как выглядит экран просмотра сведений для полей подстановки.

1. Нажмите клавишу F5 или щелкните значок предварительного просмотра (![](./media/sharepoint-lookup-fields/preview.png)).

2. Чтобы добавить запись, щелкните символ **+** в правом верхнем углу.

3. Введите **название** этого ресурса.

4. Щелкните раскрывающуюся стрелку **Тип ресурса**. В этом списке отображаются значения, указанные при создании этого поля. Выберите одну из записей.

    ![](./media/sharepoint-lookup-fields/fill-asset-type-3.png)

5. Щелкните раскрывающуюся стрелку **Мастерская**. Выберите одну из записей.

    ![](./media/sharepoint-lookup-fields/fill-repair-shop-3.png)

6. В правом верхнем углу щелкните значок флажка, чтобы сохранить новую запись.

7. (Необязательно.) Повторите эту процедуру, чтобы добавить в список необходимое количество элементов.

8. Нажмите клавишу ESC, чтобы вернуться в рабочую область по умолчанию.

## <a name="for-more-information"></a>Дополнительные сведения
* [Introducing support for lookups and a new sample app](https://powerapps.microsoft.com/blog/support-for-lookups/) (Добавление поддержки полей подстановки и новый пример приложения)
* [Performance, Refresh button, ForAll, and multiple field lookups](https://powerapps.microsoft.com/blog/performance-refresh-forall-multiple-field-lookups-531/) (Улучшение производительности, кнопка "Обновить", функция ForAll и отображение полей подстановки)
* [Создание приложения с помощью базы данных Common Data Service](data-platform-create-app.md)
* [Create an app from scratch using a Common Data Service database](data-platform-create-app-scratch.md) (Создание приложения "с нуля" с помощью базы данных Common Data Service)
