---
title: Оптимизация производительности приложений на основе холста | Документация Майкрософт
description: Следуйте рекомендациям этого раздела, чтобы повысить производительность приложений на основе холста, созданных в PowerApps.
author: yingchin
manager: kvivek
ms.service: powerapps
ms.topic: conceptual
ms.custom: canvas
ms.reviewer: anneta
ms.date: 08/31/2018
ms.author: yingchin
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: 0fa6a8f741ed0e771eeefbbee82a23e876363e55
ms.sourcegitcommit: 469be99b762cd62289a98f058c498ac25ff8801b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/10/2018
ms.locfileid: "44327785"
---
# <a name="optimize-canvas-app-performance-in-powerapps"></a>Оптимизация производительности приложений на основе холста в PowerApps
Корпорация Майкрософт прилагает все усилия, чтобы повысить производительность всех приложений, работающих на платформе PowerApps. Следуйте рекомендациям этого раздела, чтобы повысить производительность созданных приложений.

Когда пользователь открывает приложение, перед показом любого пользовательского интерфейса, он проходит такие этапы выполнения. 
1. **Проверка подлинности пользователя**. Инструктирование пользователя, если он никогда ранее не открывал приложение, как выполнить вход с учетными данными для любых подключений, необходимых для приложения. Если тот же пользователь снова откроет приложение, ему могут быть выданы инструкции еще раз, в зависимости от политик безопасности организации. 
2. **Получение метаданных**. Извлечение метаданных таких, как версия платформы PowerApps, на которой запускается приложение, и источники, из которых необходимо извлекать данные. 
3. **Инициализация приложения**. Выполнение всех задач, указанных в свойстве **OnStart**. 
4. **Отображения экранов**. Отображение первого экрана с элементами управления, которых приложение заполняет данными. Если пользователь открывает другие экраны, приложение отображает их, используя тот же процесс.  

## <a name="limit-data-connections"></a>Ограничение подключений к данным 
**Не подключайте более 30 источников данных из одного приложения**. Приложения подсказывают новым пользователям выполнить вход в каждый соединитель, поэтому каждый дополнительный соединитель увеличивает время, необходимое для запуска приложения. Когда приложение запрашивает данные из этого источника, по мере запуска приложения каждый соединитель требует ресурсы процессора, памяти и пропускной способности сети. 

Можно быстро оценить производительность приложения, включив инструменты разработчика в [Microsoft Edge](https://docs.microsoft.com/microsoft-edge/devtools-guide/network) или [Google Chrome](https://developers.google.com/web/tools/chrome-devtools/network-performance/) во время запуска приложения. Возврат данных с большей вероятностью займет более 15 секунд, если приложение часто запрашивает данные из более чем 30 источников, таких как Common Data Service для приложений, Azure SQL, SharePoint и Excel на OneDrive.  

## <a name="limit-the-number-of-controls"></a>Ограничение количества элементов управления 
**Не добавляйте более 500 элементов управления в одно приложение**. PowerApps создает HTML DOM для отрисовки каждого элемента управления. Чем больше элементов управления вы добавляете, тем больше требуется времени PowerApps. 

Если использовать коллекцию вместо отдельных элементов управления, в некоторых случаях вы можете добиться того же результата и быстрее запустить приложение. Кроме того, может потребоваться уменьшить количество типов элементов управления на одном экране. Некоторые элементы управления (такие как средство просмотра PDF, таблица данных и поле со списком) загружают большие сценарии выполнения и занимают больше времени для отрисовки. 

## <a name="optimize-the-onstart-function"></a>Оптимизация функции OnStart
Используйте функцию [**ClearCollect** ](functions/function-clear-collect-clearcollect.md) для локального кэширования данных, если она не изменяется во время сеанса пользователя. Кроме того, используйте функцию [**Concurrent**](functions/function-concurrent.md) для одновременной загрузки источников данных.

Используйте функцию **Concurrent**, чтобы сократить время, в течение которого приложение должно загружать данные наполовину, как иллюстрирует [этот раздел справки](functions/function-concurrent.md).

Без функции **Concurrent** эта формула загружает каждую из четырех таблиц по одному за раз:

    ClearCollect( Product, '[SalesLT].[Product]' );
    ClearCollect( Customer, '[SalesLT].[Customer]' );
    ClearCollect( SalesOrderDetail, '[SalesLT].[SalesOrderDetail]' );
    ClearCollect( SalesOrderHeader, '[SalesLT].[SalesOrderHeader]' )

Вы можете подтвердить это поведение в средствах для разработчиков своего веб-браузера.

![Серийная функция ClearCollect](./media/performance-tips/perfconcurrent1.png)
    
Можно включить ту же формулу в функцию **Concurrent**, чтобы сократить общее время, необходимое для работы.

    Concurrent( 
        ClearCollect( Product, '[SalesLT].[Product]' );
        ClearCollect( Customer, '[SalesLT].[Customer]' );
        ClearCollect( SalesOrderDetail, '[SalesLT].[SalesOrderDetail]' );
        ClearCollect( SalesOrderHeader, '[SalesLT].[SalesOrderHeader]' ))
        
С помощью этого изменения приложение извлекает таблицы в параллельном режиме. 

![Параллельная функция ClearCollect](./media/performance-tips/perfconcurrent2.png)  

## <a name="cache-lookup-data"></a>Данные поиска кэша
Используйте функцию **Set** для кэширования данных из просмотра локальных таблиц, чтобы избежать многократного получения данных из источника. Этот метод оптимизирует производительность, если данные с большей вероятностью не изменятся во время сеанса. Как и в этом примере, данные извлекаются из источника один раз, а после этого ссылаются локально, пока пользователь не закрывает приложение. 

    Set(CustomerOrder, Lookup(Order, id = “123-45-6789”));
    Set(CustomerName, CustomerOrder.Name);
    Set(CustomerAddress, CustomerOrder.Address);
    Set(CustomerEmail, CustomerOrder.Email);
    Set(CustomerPhone, CustomerOrder.Phone);

Контактные данные изменяются редко, как и значения по умолчанию и сведения о пользователе. Таким образом, вы можете использовать этот метод с функциями **Defaults** и **User**. 

## <a name="avoid-controls-dependency-between-screens"></a>Недопущение зависимостей элементов управления между появлением экранов
Если значение элемента управления зависит от такого же значения на другом экране, управляйте данными с помощью переменной, коллекции или ссылок источника данных.

## <a name="use-global-variables"></a>Использование глобальных переменных
Чтобы передать состояние приложения с одного экрана на другой, создайте или измените значение глобальной переменной, используя функцию [**Set**](functions/function-set.md), вместо функций **Navigate** и**UpdateContext**.

## <a name="use-delegation"></a>Использование делегирования
По возможности используйте функции, которые делегируют обработку данных в источник данных вместо того, чтобы получать данные на локальное устройство для обработки. Если приложение должно обрабатывать данные локально, для выполнения операции потребуется гораздо больше вычислительной мощности, памяти и пропускной способности сети, особенно если набор данных является большим.

Как показано в [этом списке](delegation-list.md), разные источники данных поддерживают делегирование из разных функций.

![Использование делегирования](./media/performance-tips/perfdelegation1.png)

Например, SharePoint перечисляет поддержку делегирования из функции [**Filter**](functions/function-filter-lookup.md), вместо функции [**Search**](functions/function-filter-lookup.md). Поэтому следует использовать **Filter** вместо **Search** для поиска элементов в коллекции, если список SharePoint содержит более чем 500 элементов. Дополнительные советы см. в разделе [Working with large SharePoint lists in PowerApps](https://powerapps.microsoft.com/blog/powerapps-now-supports-working-with-more-than-256-items-in-sharepoint-lists/) (Работа с большими списками SharePoint в PowerApps) (запись блога). 

## <a name="use-delayed-load"></a>Используйте отложенную загрузку
Включите [экспериментальную функцию](working-with-experimental.md) для отложенной загрузки, если ваше приложение имеет более 10 экранов и множество элементов управления, которые находятся на нескольких экранах и напрямую связаны с источником данных, и не имеют правил. Если вы создаете этот тип приложения и не включаете эту функцию, производительность приложения может снизится, так как элементы управления должны заполняться на всех экранах, даже на экранах, которые не открыты. Кроме того, все экраны приложения должны обновляться всякий раз, когда изменяется источник данных, например, когда пользователь добавляет запись.

## <a name="working-with-large-data-sets"></a>Работа с большими наборами данных
Используйте источники данных и формулы, которые можно делегировать, чтобы ваши приложения работали хорошо, а пользователи могли получить доступ ко всей необходимой им информации и избежать ограничения в 2000 строк данных для неделегированных запросов. Для записи данных столбцов, по которым пользователи могут искать, фильтровать или сортировать данные, эти индексы разрабатываются так же, как описано в документации для [SQL Server](https://docs.microsoft.com/sql/relational-databases/sql-server-index-design-guide?view=sql-server-2017) и [SharePoint](https://support.office.com/article/Add-an-index-to-a-SharePoint-column-f3f00554-b7dc-44d1-a2ed-d477eac463b0).  

## <a name="republish-apps-regularly"></a>Регулярная повторная публикация приложений
[Опубликуйте свои приложения повторно](https://powerapps.microsoft.com/blog/republish-your-apps-to-get-performance-improvements-and-additional-features/) (запись блога), чтобы получить повышение производительности и дополнительные функции от платформы PowerApps.
