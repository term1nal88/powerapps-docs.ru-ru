---
title: 'Создание и изменение отношений сущностей 1:N (один-ко-многим) или N:1 (многие-к-одному) с помощью обозревателя решений | MicrosoftDocs'
description: 'Узнайте, как создать отношение сущностей "один-ко-многим" или "многие-к-одному" с помощью обозревателя решений PowerApps'
ms.custom: ''
ms.date: 05/27/2018
ms.reviewer: ''
ms.service: crm-online
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
applies_to:
  - Dynamics 365 (online)
  - Dynamics 365 Version 9.x
  - powerapps
author: Mattp123
ms.author: matp
manager: kvivek
search.audienceType:
  - maker
search.app:
  - PowerApps
  - D365CE
---

# <a name="create-and-edit-1n-one-to-many-or-n1-many-to-one-entity-relationships-using-solution-explorer"></a>Создание и изменение отношений сущностей 1:N (один-ко-многим) или N:1 (многие-к-одному) с помощью обозревателя решений 

Обозреватель решений предоставляет один способ создания и изменения отношений сущностей 1:N (один-ко-многим) или N:1 (многие-к-одному) для Common Data Service для приложений.

[Портал PowerApps](https://web.powerapps.com/?utm_source=padocs&utm_medium=linkinadoc&utm_campaign=referralsfromdoc) позволяет настроить самые распространенные параметры, но некоторые параметры можно задать только с помощью обозревателя решений. Дополнительные сведения: 
- [Создание отношений 1: N (один-ко-многим) или N:1 (многие-к-одному)](create-edit-1n-relationships.md)
- [Создание и изменение отношений сущностей 1:N (один-ко-многим) или N:1 (многие-к-одному) на портале PowerApps](create-edit-1n-relationships-portal.md)
  
## <a name="open-solution-explorer"></a>Откройте обозреватель решений

Часть имени любого настраиваемого отношения — это префикс настройки. Это настраивается с использованием издателя решений для решения, в котором выполняется работа. Если важен префикс настройки, убедитесь, что вы работаете с неуправляемым решением, префикс настройки в котором — тот, который нужен для данной сущности. Дополнительные сведения: [Изменение префикса издателя решения](change-solution-publisher-prefix.md) 

[!INCLUDE [cc_navigate-solution-from-powerapps-portal](../../includes/cc_navigate-solution-from-powerapps-portal.md)]

## <a name="view-entity-relationships"></a>Просмотр отношений сущностей

В обозревателе решений разверните раздел **Сущности** и выберите сущность. В этой сущности выберите **Отношения 1:N** или **Отношения N:1**.

![Просмотр отношений сущностей](media/view-1n-entity-relationships-solution-explorer.png)

## <a name="create-relationships"></a>Создание отношений

Во время [просмотра отношений сущностей](#view-entity-relationships) выберите **Создать отношение "один-ко-многим"** или **Создать отношение "многие-к-одному"** на панели команд.

> [!NOTE]
> Если команды недоступны, сущность не имеет право создавать настраиваемое отношение.

Любой параметр приведет к открытию формы, такой как представлена ниже. Разница заключается в том, задано ли поле **Основная сущность** или **Связанная сущность**.

![Форма «Создать отношение "один-ко-многим"»](media/new-1n-entity-relationship-form-solution-explorer.png)

- Если выбрано **Отношение 1:N**, для текущей сущности задано значение **Основная сущность**.
- Если выбрано **Отношение N:1**, для текущей сущности задано значение **Связанная сущность**.

Необходимо задать следующие поля для сохранения отношения сущностей:

|Обязательное поле|Описание|
|--|--|
|**Основной объект**|Эта сущность будет целевым типом для поля поиска, создаваемого в связанной сущности.|
|**Связанный объект**|В эту сущность будет добавлено поле поиска для связи записей сущности с записью основной сущности.|
|**Название**|Название отношения. Будет создано значение на основе значений основной и связанной сущностей. Это поле будет иметь префикс настройки издателя решения.|
|**Отображаемое имя поля поиска**|Локализуемый текст для поля поиска, который будет создан для связанной сущности. Обычно оно совпадает с отображаемым именем основной сущности. <br /> Его можно изменить позже.|
|**Имя поля поиска**|Имя поля поиска, которое будет создано в связанной сущности. Будет создано значение, основанное на данных, введенных в поле **Отображаемое имя поля поиска**. Это поле будет иметь префикс настройки издателя решения.|

Можно нажать ![кнопку "Сохранить отношение сущностей](media/save-entity-icon-solution-explorer.png), чтобы сущность и продолжить редактирование. Дополнительные сведения: [Редактирование отношений](#edit-relationships)

> [!NOTE]
> Если значение **Имя** или **Имя поля поиска** уже существует в системе, при сохранении отобразится сообщение об ошибке. Измените значения, чтобы они стали уникальными, и повторите попытку.

## <a name="edit-relationships"></a>Редактирование отношений

Во время [просмотра отношений сущности](#view-entity-relationships) выберите сущность, которую следует изменить. После создания отношения можно изменить следующие свойства отношений сущностей.

> [!NOTE]
> Издатель управляемого решения поможет запретить некоторые настройки отношений, являющиеся частью его решения.

### <a name="entity-relationship-properties"></a>Свойства отношений сущностей

Эти свойства относятся к отношению.

|Поле|Описание|
|--|--|
|**Для поиска**|Должно ли отображаться это отношение в расширенном поиске в управляемых моделью приложениях. Выберите **Нет**, если это отношение, которое не важно для вашего бизнеса.|
|**Иерархическое**|Этот параметр включен только для отношений со ссылками на себя. Должна ли сущность учитываться для определения иерархии сущности.<br />**Важно!** После задания этого свойства поля свертки, процессы и представления можно настроить как зависимые от этого свойства. Если это значение будет изменено позже, возможности, которые зависят от иерархии, работать не будут. <br />Дополнительные сведения: [Определение и запрос иерархически связанных данных](define-query-hierarchical-data.md)|

### <a name="lookup-field"></a>Поле поиска

Это свойства поля поиска, созданные в связанной сущности. Свойства можно изменить здесь или путем изменения поля поиска напрямую. Некоторые свойства полей недоступны для редактирования из отношения. Дополнительные сведения: [Изменение поля](create-edit-field-solution-explorer.md#edit-a-field)

|Поле|Описание|
|--|--|
|**Отображаемое имя**|Локализуемый текст для поля поиска, который будет создан для связанной сущности.|
|**Требование поля**|Должно ли поле содержать данные перед сохранением формы в управляемом моделью приложении. Дополнительные сведения: [Параметры требования поля](create-edit-field-solution-explorer.md#field-requirement-options)|
|**Описание**|Введите инструкции для пользователя о назначении поля. Эти описания отображаются как подсказки для пользователя в управляемых моделью приложениях при наведении указателя мыши на метку поля.|

### <a name="navigation-pane-item-for-primary-entity"></a>Элемент области переходов для основного объекта

Из основной сущности можно переходить к связанным записям. Эти данные используются управляемыми моделью приложениями для определения способа отображения связанных записей сущностей. Эти параметры также можно изменить с помощью редактора форм.

|Поле|Описание|
|--|--|
|**Параметры отображения**|Способ отображения списка связанных сущностей. Дополнительные сведения: [Параметры отображения](#display-options)|
|**Пользовательская метка**|Укажите локализуемый текст, который будет использоваться вместо имени во множественном числе при выборе значения **Использовать специальные метки** для параметра **Параметр отображения**.|
|**Область отображения**|Выберите один из доступных вариантов группирования для отображения этого списка. Возможные варианты: **Сведения** (для группы *Общее*), **Маркетинг**, **Продажи** и **Сервис**. |
|**Порядок отображения**|Управление тем, будет ли элемент навигации включен в выбранную область отображения. Диапазон доступных номеров начинается с 10 000. Элементы области навигации с меньшим значением будут стоять в списке выше других отношений.|

<!-- TODO: Not sure whether Display Area or Display Order are still used anymore. Might only be used in the Outlook client?-->

#### <a name="display-options"></a>Параметры отображения

Доступны следующие параметры отображения:

|Параметр|Описание|
|--|--|
|**Не отображать**|Не отображать связанные сущности для этого отношения.|
|**Использовать специальные метки**|Если этот параметр выбран, поле **Пользовательская метка** включено, и вы можете указать локализуемый текст, который необходимо использовать вместо имени во множественном числе.|
|**Использовать имя во множественном числе**|Использование отображаемого имени во множественном числе, определенного для связанной сущности.|

### <a name="relationship-behavior"></a>Поведение отношений

Здесь можно определить стандартное поведение для связанных сущностей. Эта информация важна, поскольку она помогает гарантировать целостность данных и может автоматизировать бизнес-процессы компании.

Рассмотрим пример.  
  
Допустим, у вас новый продавец и требуется назначить ему несколько существующих возможных сделок, в данное время назначенных другому продавцу. Каждая запись возможной сделки может иметь несколько действий задач, связанных с ней. Можно легко найти активные возможные сделки, которые требуется переназначить, и назначить их новому продавцу. Но что произойдет с действиями задач, связанными с возможными сделками? Хотелось бы вам открывать каждую задачу и указывать, должна ли она также быть назначена новому продавцу? Скорее всего, нет. Вместо этого можно разрешить отношению применить некоторые стандартные правила автоматически. Эти правила применяются только к записям задач, связанным с возможными сделками, которые вы переназначаете. Можно выполнить следующие действия:  
  
- Переназначить все активные задачи.  
- Переназначить все задачи. 
- Не переназначать задачи.  
- Переназначить все задачи, которые в данный момент назначены бывшему владельцу возможной сделки.  
  
Отношение может управлять тем, как действия, выполняемые с записью для записи основной сущности, распространяются на все записи связанной сущности.   

Существует несколько видов поведения, которые можно применить при возникновении определенных действий.

#### <a name="behaviors"></a>Поведение

Можно настроить следующие типы поведения.

|Поведение|Описание|
|--|--|
|**Передавать активным**|Выполнение действия для всех активных записей связанной сущности.|
|**Передавать всем**|Выполнение действия для всех записей связанной сущности.|
|**Не передавать никому**|Никакие действия не выполняются.|
|**Удалить ссылку**|Удаление значения поиска всех связанных записей.|
|**Ограничить**|Блокировка возможности удаления записи основной сущности, если существуют связанные записи сущностей.|
|**Каскад для ответств.**|Выполнение действия для всех записей связанной сущности тем же пользователем, что и пользователь записи основной сущности.|

#### <a name="actions"></a>Действия

Ниже представлены действия, которые могут вызывать определенное поведение.

|Поле|Описание|Параметры|
|--|--|--|
|**Назначение**|Что должно произойти, когда запись основной сущности назначается другому пользователю?|Передавать всем<br />Передавать активным<br />Каскад для ответств.<br />Не передавать никому|
|**Переподчинение**|Что должно произойти, когда меняется значение поиска связанной сущности в отношении родительского типа?<br />Дополнительные сведения: [Родительские отношения сущностей](#parental-entity-relationships)|Передавать всем<br />Передавать активным<br />Каскад для ответств.<br />Не передавать никому|
|**Общий доступ**|Что должно произойти при совместном использовании записи основной сущности?|Передавать всем<br />Передавать активным<br />Каскад для ответств.<br />Не передавать никому|
|**Удаление**|Что должно произойти при удалении записи основной сущности?|Передавать всем<br />Удалить ссылку<br />Ограничить|
|**Отмена общего доступа**|Что должно произойти при отмене совместного использования записи основной сущности?|Передавать всем<br />Передавать активным<br />Каскад для ответств.<br />Не передавать никому|
|**Слияние**|Что должно произойти при объединении записи основной сущности?|Передавать всем<br />Не передавать никому|
|**Представление свертки**|Каково требуемое поведение представления свертки, связанного с этим отношением? |Передавать всем<br />Передавать активным<br />Каскад для ответств.<br />Не передавать никому|

<!-- TODO: I find no official docs related to rollup views, but plenty of hits online: https://www.google.com/search?q=Dynamics+365++%27rollup+view%27 -->



#### <a name="type-of-behavior-options"></a>Параметры "Тип поведения"

С помощью поля **Тип поведения** можно выбрать набор стандартных типов поведения или их настройкой независимо. 

|Параметр|Описание|
|--|--|
|**Родительский**|**Назначить**: Каскад для всех<br />**Переподчинение**: Каскад для всех<br />**Предоставить общий доступ**: Каскад для всех<br />**Удалить**: Каскад для всех<br />**Отменить общий доступ**: Каскад для всех<br />**Объединить**: Без каскадных<br />**Представление свертки**: Без каскадных \| Каскад для всех<br />|
|**Ссылочный**|**Назначить**: Без каскадных<br />**Переподчинение**: Без каскадных<br />**Предоставить общий доступ**: Без каскадных<br />**Удалить**: Удалить ссылку<br />**Отменить общий доступ**: Без каскадных<br />**Объединить**: Без каскадных<br />**Представление свертки**: Без каскадных \| Каскад для всех<br />|
|**Ссылочный, ограничить удаление**|**Назначить**: Без каскадных<br />**Переподчинение**: Без каскадных<br />**Предоставить общий доступ**: Без каскадных<br />**Удалить**: Ограничить<br />**Отменить общий доступ**: Без каскадных<br />**Объединить**: Без каскадных<br />**Представление свертки**: Без каскадных \| Каскад для всех<br />|
|**Настраиваемое каскадное**|Можно настроить нужное поведение для каждого действия в зависимости от доступных параметров.|

> [!NOTE]
> Возможно, вы не сможете выбрать параметр **Родительское**, если одна из сущностей уже участвует в родительском отношении сущностей. Дополнительные сведения: [Родительские отношения сущностей](#parental-entity-relationships)
> 
> Если использовать параметр **Настраиваемое каскадное** для задания поведения для действий, совпадающего с поведениями для действий, связанными с другим значение **Тип поведения**, то при сохранении отношения значение **Тип поведения** будет автоматически установлено равным такому совпадающему типу.  



## <a name="delete-relationships"></a>Удаление отношений

Во время [просмотра отношений](#view-entity-relationships) выберите отношение сущностей, которое требуется удалить, и выберите команду ![Команда "Удалить"](media/delete.gif).

Удаление отношения приведет к удалению поля поиска в связанной сущности.

> [!NOTE]
> Вы не сможете удалить отношение, которое имеет зависимости. Например, при добавлении поля поиска в форму для связанной сущности следует удалить поле из формы перед удалением отношения.

## <a name="parental-entity-relationships"></a>Отношения родительской сущности

Каждая пара сущностей, которые могут иметь отношение 1:N, может иметь несколько отношений 1:N между ними. Однако обычно только одно из этих отношений можно рассматривать как родительское отношение сущностей.

Родительское отношение сущностей — это любое отношение сущностей 1:N, где один из каскадных параметров в столбце **Родительское** в следующей таблице имеет значение true.

|Действие|Родительское|Не родительское|  
|------------|--------------|------------------|  
|**Назначение**|Передавать всем<br />Каскад для ответств.<br />Передавать активным|Не передавать никому|  
|**Удаление**|Передавать всем|Удалить ссылку<br />Ограничить|  
|**Переподчинение**|Передавать всем<br />Каскад для ответств.<br />Передавать активным|Не передавать никому|  
|**Общий доступ**|Передавать всем<br />Каскад для ответств.<br />Передавать активным|Не передавать никому|  
|**Отмена общего доступа**|Передавать всем<br />Каскад для ответств.<br />Передавать активным|Не передавать никому|  

Например, если вы создаете новую настраиваемую сущность и добавляете отношение сущностей 1:N с сущностью учетной записи, где настраиваемая сущность является связанной сущностью, можно настроить действия для этого отношения сущностей для использования параметров в столбце **Родительское**. Если позже добавить еще одно отношение сущностей 1:N с настраиваемой сущностью в качестве ссылочной сущности, можно настроить действия только для использования параметров в столбце **Не родительское**.

Обычно это означает, что для каждой пары сущностей существует только одно родительское отношение. В некоторых случаях при поиске в связанной сущности учитывается отношение с несколькими типами сущности.

Например, если в сущности настроен поиск по клиенту, который может ссылаться на сущность контакта или организации. Существует два отдельных родительских отношения сущностей 1:N.

Любая сущность действия имеет похожий набор родительских отношений сущностей для сущностей, которые можно связать с помощью поля поиска "в отношении".

<a name="BKMK_RelationshipBehaviorLimitations"></a>   

### <a name="limitations-on-behaviors-you-can-set"></a>Доступные ограничения поведения
  
Из-за родительских отношений существует ряд ограничений, которые необходимо учитывать при определении отношений сущностей.  
  
- Настраиваемая сущность не может быть основной в каскадном отношении со связанной системной сущностью. Это означает, что между основной настраиваемой сущностью и связанной системной сущностью не может быть отношений с каким-либо из действий со значением **Передавать всем**, **Передавать активным** или **Передавать владельцу**.  
- У новых отношений действие не может иметь значение **Передавать всем**, **Передавать активным** или **Передавать владельцу**, если связанная сущность в этом отношении уже является связанной сущностью в любом другом отношении, действие которого имеет значение **Передавать всем**, **Передавать активным** или **Передавать владельцу**. Это позволяет избежать создания отношений с несколькими родительскими сущностями.  

### <a name="see-also"></a>См. также

[Создание и изменение отношений между сущностями](create-edit-entity-relationships.md)<br />
[Создание и изменение отношений 1:N (один-ко-многим) или N:1 (многие-к-одному)](create-edit-1n-relationships.md)<br />
[Создание и изменение отношений сущностей 1:N (один-ко-многим) или N:1 (многие-к-одному) на портале PowerApps](create-edit-1n-relationships-portal.md)<br />
[Создание отношений N:N (многие-ко-многим)](create-edit-nn-relationships.md)

