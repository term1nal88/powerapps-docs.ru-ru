---
title: Использование поставщика данных виртуальной сущности OData v4 с Common Data Service для приложений | MicrosoftDocs
ms.custom: ''
ms.date: 06/04/2018
ms.reviewer: ''
ms.service: crm-online
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
applies_to:
  - Dynamics 365 (online)
  - Dynamics 365 Version 9.x
ms.assetid: null
caps.latest.revision: null
author: Mattp123
ms.author: matp
manager: kvivek
search.audienceType:
  - maker
search.app:
  - PowerApps
  - D365CE
---

# <a name="odata-v4-data-provider-configuration-requirements-and-best-practices"></a>Конфигурация, требования и рекомендации для поставщика данных OData v4

В этом разделе описывается порядок настройки поставщика данных OData v4, а также требования и рекомендации по использованию поставщика данных OData v4 для подключения к веб-службе OData v4. 

## <a name="odata-v4-data-provider-best-practices"></a>Рекомендации для поставщика данных OData v4

- Common Data Service для приложений требует, чтобы все сущности имели атрибут ID, который называется уникальным идентификатором и должен иметь значение типа GUID.  Поля ID можно сопоставлять только с внешними полями с типом данных `Edm.Guid`.  Невозможно сопоставить тип данных `Edm.Int32` с полем с типом данных уникального идентификатора в CDS для приложений.
-  Сущности OData со свойствами, которые могут принимать значение NULL, должны быть заданы в соответствии с сопоставленным полем в виртуальной сущности. Например, свойство сущности OData со значением Nullable=False должно быть сопоставлено полю в CDS для приложений с атрибутом **Требование поля**, имеющим значение **Требуется для бизнеса**. 
- Для извлечения нескольких запросов, например при загрузке данных в сетку, контролируйте размер набора данных, возвращенного из внешнего источника данных, с помощью параметров выбора и фильтрации запроса.
- Если еще не включено, системные администраторы должны включить отслеживание подключаемого модуля. После включения все ошибки из конечной точки OData регистрируются в журнале трассировки подключаемого модуля. Дополнительные сведения: [Руководство администратора. Диалоговое окно "Системные параметры" — вкладка "Настройка"](/dynamics365/customer-engagement/admin/system-settings-dialog-box-customization-tab). 

## <a name="data-type-mapping"></a>Сопоставление типов данных

В следующей таблице перечислены сопоставления типов данных модели данных сущности (EDM) OData с типами данных CDS для приложений. 

|Тип данных OData|Типы данных CDS для приложений  |
|---------|---------|
|`Edm.Boolean`|Два параметра|
|`Edm.DateTime`|Дата и время|
|`Edm.DateTimeOffset`|Дата и время|
|`Edm.Decimal`|Десятичное число или валюта|
|`Edm.Double`|Число с плавающей запятой|
|`Edm.Guid`|Уникальный идентификатор|
|`Edm.Int32`|Целое число|
|`Edm.Int64`|Целое число|
|`Edm.String`|Одна строка текста или несколько строк текста|


### <a name="odata-edm-data-types-that-are-not-supported-for-mapping-with-virtual-entities"></a>Типы данных OData EDM, которые не поддерживаются для сопоставления с виртуальными сущностями 

- `Edm.Binary `
- `Edm.Time` 
- `Edm.Float `
- `Edm.Single` 
- `Edm.Int16` 
- `Edm.Byte` 
- `Edm.SByte`

 
## <a name="add-a-data-source-using-the-odata-v4-data-provider"></a>Добавление источника данных с использованием поставщика данных OData v4

Эта процедура описывает порядок использования готового поставщика данных OData в качестве источника данных виртуальной сущности.   
  
1. Перейдите в раздел **[Параметры](../model-driven-apps/advanced-navigation.md#settings)** > **Администрирование** > **Источники данных виртуальных сущностей**.  
1. На панели действий нажмите кнопку **Создать**.  
1. В диалоговом окне **Выберите поставщика данных** выберите одного из следующих поставщиков данных, затем нажмите **ОК**.  
  
    - **Поставщик данных OData v4**. CDS для приложений включает поставщика данных Odata v4, который может использоваться для подключения к источникам данных, поддерживающим открытый стандарт OData v4.  
    - *Настраиваемый поставщик данных*. Если был импортирован подключаемый модуль поставщика данных, этот поставщик данных будет отображаться здесь. Дополнительные сведения: [Документация для разработчиков. Начало работы с виртуальными сущностями](/dynamics365/customer-engagement/developer/virtual-entities/get-started-ve)  
    
1. На странице свойств **Новый источник данных** заполните указанные ниже поля, затем сохраните запись.  
  
    - **Имя**. Введите имя, которое описывает источник данных.  
    - **URI-адрес**. При использовании поставщика данных OData введите URI-адрес для веб-службы OData. Например, если используется поставщик OData для подключения к веб-службе, размещенной в Azure, URI-адрес может выглядеть подобно следующему: *`http://contosodataservice.azurewebsites.net/odata/`*.  
    - **Время ожидания в секундах**. Введите число секунд ожидания ответа веб-службы перед отменой запроса данных из-за истечения времени ожидания. Например, введите 30 для ожидания не более 30 секунд до истечения срока ожидания.  
    - **Режим разбиения на страницы**. Выберите, требуется ли использовать разбиение на страницы на стороне клиента или на стороне сервера для управления разбиением на страницы результатов запроса. Значение по умолчанию — разбиение на страницы на стороне клиента. В случае разбиения на страницы на стороне сервера разбиение результатов на страницы контролируется сервером с помощью параметра $skiptoken, который добавляется к строке запроса. Дополнительные сведения: [Системный параметр запроса с токеном пропуска ($skiptoken)](https://msdn.microsoft.com/library/dd942121.aspx)  
        -  **Вернуть количество в строке**. Возвращает общее количество записей в наборе результатов. Этот параметр используется для включения функции следующей страницы при возврате данных в сетку. Используйте значения false, если ваша конечная точка OData не поддерживает параметра OData $inclinecount. По умолчанию используется значение false.
    - **Параметры запроса**. Если требуется, можно добавить настраиваемый заголовок или параметры строки запроса, используемые для подключения к веб-службе OData, например параметры проверки подлинности с помощью внешней службы. Щелкните **Строка запроса** для переключения между заголовком и параметром и значением строки запроса. Можно добавить не более 10 заголовков или строк запроса. 
        > [!div class="mx-imgBorder"] 
        > ![Запись источника данных виртуальной сущности](media/virtual-entity-data-source.png) 


## <a name="see-also"></a>См. также  

[Создание и изменение виртуальных сущностей, содержащих данные из внешнего источника данных](create-edit-virtual-entities.md) <br/>
[Блог TechNet. Взаимодействие с данными из внешних систем с помощью новых виртуальных сущностей](https://blogs.technet.microsoft.com/lystavlen/2017/09/08/virtual-entities/)
