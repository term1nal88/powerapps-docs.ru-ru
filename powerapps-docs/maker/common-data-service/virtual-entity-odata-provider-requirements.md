---
title: Использование поставщика данных виртуальных сущностей OData версии 4 с Common Data Service for Apps | Документы Майкрософт
ms.custom: ''
ms.date: 06/04/2018
ms.reviewer: ''
ms.service: crm-online
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
applies_to:
- Dynamics 365 (online)
- Dynamics 365 Version 9.x
ms.assetid: ''
caps.latest.revision: ''
author: Mattp123
ms.author: matp
manager: brycho
ms.openlocfilehash: 0bd2aed852b5d7eb9b354f30978725b1386a89aa
ms.sourcegitcommit: aba996b1773ecdf62758e06b34eaf57bede29e08
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/08/2018
ms.locfileid: "39703479"
---
# <a name="odata-v4-data-provider-configuration-requirements-and-best-practices"></a>Конфигурация, требования и рекомендации для поставщика данных OData версии 4

В этом разделе описывается настройка поставщика данных OData версии 4, а также приводятся требования и рекомендации по использованию поставщика данных OData версии 4 для подключения веб-службы OData v4. 

## <a name="odata-v4-data-provider-best-practices"></a>Рекомендации по использованию поставщика данных OData версии 4

- Common Data Service for Apps требует, чтобы все сущности имели атрибут "Идентификатор". Это уникальный идентификатор GUID.  Поля идентификатора можно сопоставить только с внешними полями, имеющими тип данных "`Edm.Guid`".  Нельзя сопоставить тип данных "`Edm.Int32`" с типом данных поля "Уникальный идентификатор" в CDS for Apps.
-  Сущности OData с обнуляемыми свойствами должны совпадать с сопоставленным полем в виртуальной сущности. Например, для свойства сущности OData со значением "Nullable=False" атрибут **Требование поля** сопоставленного поля CDS for Apps должен иметь значение **Требуется для бизнеса**. 
- При извлечении данных с использованием нескольких запросов, например при загрузке данных в сетку, можно контролировать размер набора данных, возвращаемого из внешнего источника данных, с помощью параметров запроса select и filter.
- Системным администраторам следует включить трассировку подключаемого модуля, если эта функция еще не включена. После включения все ошибки из конечной точки OData записываются в журнал трассировки подключаемых модулей. Дополнительные сведения: [Руководство администратора: диалоговое окно "Системные параметры" — вкладка "Настройки"](/dynamics365/customer-engagement/admin/system-settings-dialog-box-customization-tab) 

## <a name="data-type-mapping"></a>Сопоставление типов данных

В таблице ниже перечислены варианты сопоставления типов данных модели OData EDM с типами данных CDS for Apps. 

|Тип данных OData|Тип данных CDS for Apps  |
|---------|---------|
|`Edm.Boolean`|два варианта;|
|`Edm.DateTime`|Дата и время|
|`Edm.DateTimeOffset`|Дата и время|
|`Edm.Decimal`|Десятичное число или валюта|
|`Edm.Double`|Число с плавающей запятой|
|`Edm.Guid`|Уникальный идентификатор|
|`Edm.Int32`|целое число;|
|`Edm.Int64`|целое число;|
|`Edm.String`|Однострочный или многострочный текст|


### <a name="odata-edm-data-types-that-are-not-supported-for-mapping-with-virtual-entities"></a>Типы данных модели OData EDM, которые не поддерживаются для сопоставления с виртуальными сущностями 

- `Edm.Binary `
- `Edm.Time` 
- `Edm.Float `
- `Edm.Single` 
- `Edm.Int16` 
- `Edm.Byte` 
- `Edm.SByte`

 
## <a name="add-a-data-source-using-the-odata-v4-data-provider"></a>Добавление источника данных с помощью поставщика данных OData версии 4

В этой процедуре показано, как использовать готовый поставщик данных OData в качестве источника данных виртуальных сущностей.   
  
1. Перейдите в раздел **[Параметры](../model-driven-apps/advanced-navigation.md#settings)** > **Администрирование** > **Источники данных виртуальных сущностей**.  
1. На панели инструментов действий щелкните **Создать**.  
1. В диалоговом окне **Выберите поставщика данных** выберите один из следующих источников данных и щелкните **ОК**.  
  
    - **Поставщик данных OData версии 4**. CDS for Apps содержит поставщик данных OData версии 4, который может использоваться для подключения к источникам данных, поддерживающим открытый стандарт OData версии 4.  
    - *Настраиваемый поставщик данных*. Если был импортирован подключаемый модуль поставщика данных, этот поставщик данных будет отображаться здесь. Дополнительные сведения: [Документация для разработчиков. Начало работы с виртуальными сущностями](/dynamics365/customer-engagement/developer/virtual-entities/get-started-ve)  
    
1. На странице свойств **Новый источник данных** заполните следующие поля и сохраните запись.  
  
    - **Имя**. Введите имя, которое описывает источник данных.  
    - **URI**. Если используется поставщик данных OData, введите URI веб-службы OData. Например, если поставщик OData используется для подключения к веб-службе, размещенной в Azure, URI может выглядеть так: *`http://contosodataservice.azurewebsites.net/odata/`*.  
    - **Время ожидания в секундах**. Укажите время ожидания ответа от веб-службы до тайм-аута запроса к данным (в секундах). Например, введите значение 30, чтобы перед тем, как время ожидания ответа истечет, проходило не более 30 секунд.  
    - **Разбивка на страницы**. Выберите, где должно осуществляться разбиение результатов запроса на страницы — на стороне клиента или на стороне сервера. Значение по умолчанию — разбиение на страницы на стороне клиента. При разбиении на страницы на стороне сервера размер страницы определяется с помощью параметра $skiptoken, который добавляется к строке запроса. Дополнительные сведения: [Игнорируемый токен в параметрах системного запроса ($skiptoken)](https://msdn.microsoft.com/library/dd942121.aspx)  
        -  **Возврат результатов встроенной функции count**. Возвращает общее количество записей в наборе результатов. Этот параметр обеспечивает возможность перехода на следующую страницу при возврате данных в сетку. Используйте значение false, если конечная точка OData не поддерживает параметр OData $inclinecount. По умолчанию используется значение false.
    - **Параметры запроса**. При необходимости можно добавить настраиваемые параметры заголовка или строки запроса для подключения к веб-службе OData, такие как параметры проверки подлинности для внешней службы. Щелкните **Строка запроса** для переключения между параметром заголовка или строки запроса и значением. Можно добавить до 10 заголовков или строк запроса. 
        ![Запись источника данных виртуальной сущности](media/virtual-entity-data-source.png) 


## <a name="see-also"></a>См. также  

[Создание и изменение виртуальных сущностей, содержащих данные из внешнего источника данных](create-edit-virtual-entities.md) <br/>
[Блог TechNet. Взаимодействие с данными из внешних систем с помощью новых виртуальных сущностей](https://blogs.technet.microsoft.com/lystavlen/2017/09/08/virtual-entities/)
